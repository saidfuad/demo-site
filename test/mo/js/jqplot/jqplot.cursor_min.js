(function(g){function n(a,d,b){var c=b.plugins.cursor,e="",f=!1;c.showTooltipGridPosition&&(e=a.x+", "+a.y,f=!0);if(c.showTooltipUnitPosition)for(var i,h=0;h<c.tooltipAxisGroups.length;h++){i=c.tooltipAxisGroups[h];f&&(e+="<br />");if(c.useAxesFormatters)var j=b.axes[i[0]]._ticks[0].formatter,k=b.axes[i[1]]._ticks[0].formatter,l=b.axes[i[0]]._ticks[0].formatString,m=b.axes[i[1]]._ticks[0].formatString,e=e+(j(l,d[i[0]])+", "+k(m,d[i[1]]));else e+=g.jqplot.sprintf(c.tooltipFormatString,d[i[0]],d[i[1]]); f=!0}if(c.showTooltipDataPosition){d=b.series;a=q(b,a.x,a.y);f=!1;for(h=0;h<d.length;h++)d[h].show&&(b=d[h].label.toString(),k=g.inArray(d[h].index,a.indices),m=j=void 0,-1!=k&&(i=a.data[k].data,c.useAxesFormatters?(j=d[h]._xaxis._ticks[0].formatter,k=d[h]._yaxis._ticks[0].formatter,l=d[h]._xaxis._ticks[0].formatString,m=d[h]._yaxis._ticks[0].formatString,j=j(l,i[0]),m=k(m,i[1])):(j=i[0],m=i[1]),f&&(e+="<br />"),e+=g.jqplot.sprintf(c.tooltipFormatString,b,j,m),f=!0))}c._tooltipElem.html(e)}function r(a, d){var b=d.plugins.cursor,c=b.cursorCanvas._ctx;c.clearRect(0,0,c.canvas.width,c.canvas.height);b.showVerticalLine&&b.shapeRenderer.draw(c,[[a.x,0],[a.x,c.canvas.height]]);b.showHorizontalLine&&b.shapeRenderer.draw(c,[[0,a.y],[c.canvas.width,a.y]]);c=q(d,a.x,a.y);if(b.showCursorLegend)for(var e=g(d.targetId+" td.jqplot-cursor-legend-label"),f=0;f<e.length;f++){var i=g(e[f]).data("seriesIndex"),h=d.series[i],j=h.label.toString(),k=g.inArray(i,c.indices),l=i=void 0;if(-1!=k)if(k=c.data[k].data,b.useAxesFormatters)var i= h._xaxis._ticks[0].formatter,l=h._yaxis._ticks[0].formatter,m=h._yaxis._ticks[0].formatString,i=i(h._xaxis._ticks[0].formatString,k[0]),l=l(m,k[1]);else i=k[0],l=k[1];d.legend.escapeHtml?g(e[f]).text(g.jqplot.sprintf(b.cursorLegendFormatString,j,i,l)):g(e[f]).html(g.jqplot.sprintf(b.cursorLegendFormatString,j,i,l))}}function q(a,d){var b={indices:[],data:[]},c,e,f,i,h=a.plugins.cursor;for(e=0;e<a.series.length;e++)if(c=a.series[e],c.show){i=h.intersectionThreshold;c.showMarker&&(i+=c.markerRenderer.size/ 2);for(f=0;f<c.gridData.length;f++)p=c.gridData[f],h.showVerticalLine&&Math.abs(d-p[0])<=i&&(b.indices.push(e),b.data.push({seriesIndex:e,pointIndex:f,gridData:p,data:c.data[f]}))}return b}function o(a,d){var b=d.plugins.cursor,c=b._tooltipElem;switch(b.tooltipLocation){case "nw":var e=a.x+d._gridPadding.left-c.outerWidth(!0)-b.tooltipOffset,c=a.y+d._gridPadding.top-b.tooltipOffset-c.outerHeight(!0);break;case "n":e=a.x+d._gridPadding.left-c.outerWidth(!0)/2;c=a.y+d._gridPadding.top-b.tooltipOffset- c.outerHeight(!0);break;case "ne":e=a.x+d._gridPadding.left+b.tooltipOffset;c=a.y+d._gridPadding.top-b.tooltipOffset-c.outerHeight(!0);break;case "e":e=a.x+d._gridPadding.left+b.tooltipOffset;c=a.y+d._gridPadding.top-c.outerHeight(!0)/2;break;case "se":e=a.x+d._gridPadding.left+b.tooltipOffset;c=a.y+d._gridPadding.top+b.tooltipOffset;break;case "s":e=a.x+d._gridPadding.left-c.outerWidth(!0)/2;c=a.y+d._gridPadding.top+b.tooltipOffset;break;case "sw":e=a.x+d._gridPadding.left-c.outerWidth(!0)-b.tooltipOffset; c=a.y+d._gridPadding.top+b.tooltipOffset;break;case "w":e=a.x+d._gridPadding.left-c.outerWidth(!0)-b.tooltipOffset;c=a.y+d._gridPadding.top-c.outerHeight(!0)/2;break;default:e=a.x+d._gridPadding.left+b.tooltipOffset,c=a.y+d._gridPadding.top+b.tooltipOffset}b._tooltipElem.css("left",e);b._tooltipElem.css("top",c)}function u(a,d,b,c,e){a.preventDefault();a.stopImmediatePropagation();a=e.plugins.cursor;a.clickReset&&a.resetZoom(e,a);e=window.getSelection;document.selection&&document.selection.empty? document.selection.empty():e&&!e().isCollapsed&&e().collapse();return!1}function v(a,d,b,c,e){a.preventDefault();a.stopImmediatePropagation();a=e.plugins.cursor;a.dblClickReset&&a.resetZoom(e,a);e=window.getSelection;document.selection&&document.selection.empty?document.selection.empty():e&&!e().isCollapsed&&e().collapse();return!1}function w(a,d,b,c,e){c=e.plugins.cursor;c.onGrid=!1;if(c.show){g(a.target).css("cursor",c.previousCursor);c.showTooltip&&(!c._zoom.zooming||!c.showTooltipOutsideZoom|| c.constrainOutsideZoom)&&c._tooltipElem.hide();c.zoom&&(c._zoom.gridpos=d,c._zoom.datapos=b);if(c.showVerticalLine||c.showHorizontalLine)a=c.cursorCanvas._ctx,a.clearRect(0,0,a.canvas.width,a.canvas.height);if(c.showCursorLegend){a=g(e.targetId+" td.jqplot-cursor-legend-label");for(d=0;d<a.length;d++)b=g(a[d]).data("seriesIndex"),b=e.series[b].label.toString(),e.legend.escapeHtml?g(a[d]).text(g.jqplot.sprintf(c.cursorLegendFormatString,b,void 0,void 0)):g(a[d]).html(g.jqplot.sprintf(c.cursorLegendFormatString, b,void 0,void 0))}}}function x(a,d,b,c,e){c=e.plugins.cursor;c.onGrid=!0;if(c.show){c.previousCursor=a.target.style.cursor;a.target.style.cursor=c.style;if(c.showTooltip){n(d,b,e);if(c.followMouse)o(d,e);else{var f=e._gridPadding,i=e.plugins.cursor,a=i._tooltipElem;switch(i.tooltipLocation){case "nw":b=f.left+i.tooltipOffset;f=f.top+i.tooltipOffset;a.css("left",b);a.css("top",f);break;case "n":b=(f.left+(e._plotDimensions.width-f.right))/2-a.outerWidth(!0)/2;f=f.top+i.tooltipOffset;a.css("left",b); a.css("top",f);break;case "ne":b=f.right+i.tooltipOffset;f=f.top+i.tooltipOffset;a.css({right:b,top:f});break;case "e":b=f.right+i.tooltipOffset;f=(f.top+(e._plotDimensions.height-f.bottom))/2-a.outerHeight(!0)/2;a.css({right:b,top:f});break;case "se":b=f.right+i.tooltipOffset;f=f.bottom+i.tooltipOffset;a.css({right:b,bottom:f});break;case "s":b=(f.left+(e._plotDimensions.width-f.right))/2-a.outerWidth(!0)/2;f=f.bottom+i.tooltipOffset;a.css({left:b,bottom:f});break;case "sw":b=f.left+i.tooltipOffset; f=f.bottom+i.tooltipOffset;a.css({left:b,bottom:f});break;case "w":b=f.left+i.tooltipOffset;f=(f.top+(e._plotDimensions.height-f.bottom))/2-a.outerHeight(!0)/2;a.css({left:b,top:f});break;default:b=f.right-i.tooltipOffset,f=f.bottom+i.tooltipOffset,a.css({right:b,bottom:f})}}c._tooltipElem.show()}(c.showVerticalLine||c.showHorizontalLine)&&r(d,e)}}function y(a,d,b,c,e){a=e.plugins.cursor;a.show&&(a.showTooltip&&(n(d,b,e),a.followMouse&&o(d,e)),(a.showVerticalLine||a.showHorizontalLine)&&r(d,e))}function t(a){var d= a.data.plot,b=d.plugins.cursor;if(b.show&&b.zoom&&b._zoom.started&&!b.zoomTarget){var c=b.zoomCanvas._ctx,e=a.data.plot,f=e.eventCanvas._elem.offset(),a={x:a.pageX-f.left,y:a.pageY-f.top},f={xaxis:null,yaxis:null,x2axis:null,y2axis:null,y3axis:null,y4axis:null,y5axis:null,y6axis:null,y7axis:null,y8axis:null,y9axis:null},i="xaxis yaxis x2axis y2axis y3axis y4axis y5axis y6axis y7axis y8axis y9axis".split(" "),e=e.axes,h,g;for(h=11;0<h;h--)g=i[h-1],e[g].show&&(f[g]=e[g].series_p2u(a[g.charAt(0)])); b._zoom.gridpos=a;b._zoom.datapos=f;b._zoom.zooming=!0;i=a.x;e=a.y;h=c.canvas.height;c=c.canvas.width;b.showTooltip&&(!b.onGrid&&b.showTooltipOutsideZoom)&&(n(a,f,d),b.followMouse&&o(a,d));b._zoom.end="x"==b.constrainZoomTo?[i,h]:"y"==b.constrainZoomTo?[c,e]:[i,e];d=window.getSelection;document.selection&&document.selection.empty?document.selection.empty():d&&!d().isCollapsed&&d().collapse();z.call(b)}}function A(a,d,b,c,e){a=e.plugins.cursor;g(document).one("mouseup.jqplot_cursor",{plot:e},B);void 0!= document.onselectstart&&(a._oldHandlers.onselectstart=document.onselectstart,document.onselectstart=function(){return!1});void 0!=document.ondrag&&(a._oldHandlers.ondrag=document.ondrag,document.ondrag=function(){return false});void 0!=document.onmousedown&&(a._oldHandlers.onmousedown=document.onmousedown,document.onmousedown=function(){return false});if(a.zoom){a.zoomProxy||(c=a.zoomCanvas._ctx,c.clearRect(0,0,c.canvas.width,c.canvas.height));a._zoom.start="x"==a.constrainZoomTo?[d.x,0]:"y"==a.constrainZoomTo? [0,d.y]:[d.x,d.y];a._zoom.started=!0;for(var f in b)a._zoom.axes.start[f]=b[f];g(document).bind("mousemove.jqplotCursor",{plot:e},t)}}function B(a){var a=a.data.plot,d=a.plugins.cursor;if(d.zoom&&d._zoom.zooming&&!d.zoomTarget){var b=d._zoom.gridpos.x,c=d._zoom.gridpos.y,e=d._zoom.datapos,f=d.zoomCanvas._ctx.canvas.height,i=d.zoomCanvas._ctx.canvas.width,h=a.axes;if(d.constrainOutsideZoom&&!d.onGrid){0>b?b=0:b>i&&(b=i);0>c?c=0:c>f&&(c=f);for(var j in e)e[j]&&(e[j]="x"==j.charAt(0)?h[j].series_p2u(b): h[j].series_p2u(c))}"x"==d.constrainZoomTo?c=f:"y"==d.constrainZoomTo&&(b=i);d._zoom.end=[b,c];d._zoom.gridpos={x:b,y:c};d.doZoom(d._zoom.gridpos,e,a,d)}d._zoom.started=!1;d._zoom.zooming=!1;g(document).unbind("mousemove.jqplotCursor",t);void 0!=document.onselectstart&&null!=d._oldHandlers.onselectstart&&(document.onselectstart=d._oldHandlers.onselectstart,d._oldHandlers.onselectstart=null);void 0!=document.ondrag&&null!=d._oldHandlers.ondrag&&(document.ondrag=d._oldHandlers.ondrag,d._oldHandlers.ondrag= null);void 0!=document.onmousedown&&null!=d._oldHandlers.onmousedown&&(document.onmousedown=d._oldHandlers.onmousedown,d._oldHandlers.onmousedown=null)}function z(){var a=this._zoom.start,d=this._zoom.end,b=this.zoomCanvas._ctx,c,e,f;d[0]>a[0]?(c=a[0],f=d[0]-a[0]):(c=d[0],f=a[0]-d[0]);d[1]>a[1]?(e=a[1],a=d[1]-a[1]):(e=d[1],a=a[1]-d[1]);b.fillStyle="rgba(0,0,0,0.2)";b.strokeStyle="#999999";b.lineWidth=1;b.clearRect(0,0,b.canvas.width,b.canvas.height);b.fillRect(0,0,b.canvas.width,b.canvas.height); b.clearRect(c,e,f,a);b.strokeRect(c,e,f,a)}g.jqplot.Cursor=function(a){this.style="crosshair";this.previousCursor="auto";this.show=g.jqplot.config.enablePlugins;this.showTooltip=!0;this.followMouse=!1;this.tooltipLocation="se";this.tooltipOffset=6;this.showTooltipGridPosition=!1;this.showTooltipUnitPosition=!0;this.showTooltipDataPosition=!1;this.tooltipFormatString="%.4P, %.4P";this.useAxesFormatters=!0;this.tooltipAxisGroups=[];this.clickReset=this.zoomTarget=this.zoomProxy=this.zoom=!1;this.dblClickReset= !0;this.showHorizontalLine=this.showVerticalLine=!1;this.constrainZoomTo="none";this.shapeRenderer=new g.jqplot.ShapeRenderer;this._zoom={start:[],end:[],started:!1,zooming:!1,isZoomed:!1,axes:{start:{},end:{}},gridpos:{},datapos:{}};this._tooltipElem;this.zoomCanvas;this.cursorCanvas;this.intersectionThreshold=2;this.showCursorLegend=!1;this.cursorLegendFormatString=g.jqplot.Cursor.cursorLegendFormatString;this._oldHandlers={onselectstart:null,ondrag:null,onmousedown:null};this.constrainOutsideZoom= !0;this.onGrid=this.showTooltipOutsideZoom=!1;g.extend(!0,this,a)};g.jqplot.Cursor.cursorLegendFormatString="%s x:%s, y:%s";g.jqplot.Cursor.init=function(a,d,b){a=b||{};this.plugins.cursor=new g.jqplot.Cursor(a.cursor);var c=this.plugins.cursor;if(c.show&&(g.jqplot.eventListenerHooks.push(["jqplotMouseEnter",x]),g.jqplot.eventListenerHooks.push(["jqplotMouseLeave",w]),g.jqplot.eventListenerHooks.push(["jqplotMouseMove",y]),c.showCursorLegend&&(b.legend=b.legend||{},b.legend.renderer=g.jqplot.CursorLegendRenderer, b.legend.formatString=this.plugins.cursor.cursorLegendFormatString,b.legend.show=!0),c.zoom&&(g.jqplot.eventListenerHooks.push(["jqplotMouseDown",A]),c.clickReset&&g.jqplot.eventListenerHooks.push(["jqplotClick",u]),c.dblClickReset&&g.jqplot.eventListenerHooks.push(["jqplotDblClick",v])),this.resetZoom=function(){var a=this.axes;if(c.zoomProxy){a=this.plugins.cursor.zoomCanvas._ctx;a.clearRect(0,0,a.canvas.width,a.canvas.height)}else{for(var b in a)a[b].reset();this.redraw()}this.plugins.cursor._zoom.isZoomed= false;this.target.trigger("jqplotResetZoom",[this,this.plugins.cursor])},c.showTooltipDataPosition))c.showTooltipUnitPosition=!1,c.showTooltipGridPosition=!1,void 0==a.cursor.tooltipFormatString&&(c.tooltipFormatString=g.jqplot.Cursor.cursorLegendFormatString)};g.jqplot.Cursor.postDraw=function(){var a=this.plugins.cursor;a.zoomCanvas=new g.jqplot.GenericCanvas;this.eventCanvas._elem.before(a.zoomCanvas.createElement(this._gridPadding,"jqplot-zoom-canvas",this._plotDimensions));a.zoomCanvas.setContext(); a._tooltipElem=g('<div class="jqplot-cursor-tooltip" style="position:absolute;display:none"></div>');a.zoomCanvas._elem.before(a._tooltipElem);if(a.showVerticalLine||a.showHorizontalLine)a.cursorCanvas=new g.jqplot.GenericCanvas,this.eventCanvas._elem.before(a.cursorCanvas.createElement(this._gridPadding,"jqplot-cursor-canvas",this._plotDimensions)),a.cursorCanvas.setContext();if(a.showTooltipUnitPosition&&0===a.tooltipAxisGroups.length){for(var d=this.series,b,c=[],e=0;e<d.length;e++)b=d[e],b=b.xaxis+ ","+b.yaxis,-1==g.inArray(b,c)&&c.push(b);for(e=0;e<c.length;e++)a.tooltipAxisGroups.push(c[e].split(","))}};g.jqplot.Cursor.zoomProxy=function(a,d){var b=a.plugins.cursor,c=d.plugins.cursor;b.zoomTarget=!0;b.zoom=!0;b.style="auto";b.dblClickReset=!1;c.zoom=!0;c.zoomProxy=!0;d.target.bind("jqplotZoom",function(c,d,g,h,j){b.doZoom(d,g,a,j)});d.target.bind("jqplotResetZoom",function(){a.resetZoom()})};g.jqplot.Cursor.prototype.resetZoom=function(a,d){var b=a.axes,c=d._zoom.axes;if(!a.plugins.cursor.zoomProxy&& d._zoom.isZoomed){for(var e in b)b[e]._ticks=[],b[e].min=c[e].min,b[e].max=c[e].max,b[e].numberTicks=c[e].numberTicks,b[e].tickInterval=c[e].tickInterval,b[e].daTickInterval=c[e].daTickInterval;a.redraw();d._zoom.isZoomed=!1}else b=d.zoomCanvas._ctx,b.clearRect(0,0,b.canvas.width,b.canvas.height);a.target.trigger("jqplotResetZoom",[a,d])};g.jqplot.Cursor.resetZoom=function(a){a.resetZoom()};g.jqplot.Cursor.prototype.doZoom=function(a,d,b,c){var e=b.axes,f=c._zoom.axes.start,g=b.plugins.cursor.zoomCanvas._ctx; if("none"==c.constrainZoomTo&&6<Math.abs(a.x-c._zoom.start[0])&&6<Math.abs(a.y-c._zoom.start[1])||"x"==c.constrainZoomTo&&6<Math.abs(a.x-c._zoom.start[0])||"y"==c.constrainZoomTo&&6<Math.abs(a.y-c._zoom.start[1])){if(!b.plugins.cursor.zoomProxy){for(var h in d)if(void 0==c._zoom.axes[h]&&(c._zoom.axes[h]={},c._zoom.axes[h].numberTicks=e[h].numberTicks,c._zoom.axes[h].tickInterval=e[h].tickInterval,c._zoom.axes[h].daTickInterval=e[h].daTickInterval,c._zoom.axes[h].min=e[h].min,c._zoom.axes[h].max= e[h].max),"none"==c.constrainZoomTo||"x"==c.constrainZoomTo&&"x"==h.charAt(0)||"y"==c.constrainZoomTo&&"y"==h.charAt(0))dp=d[h],null!=dp&&(dp>f[h]?(e[h].min=f[h],e[h].max=dp):(span=f[h]-dp,e[h].max=f[h],e[h].min=dp),e[h].tickInterval=null,e[h].daTickInterval=null,e[h]._ticks=[]);g.clearRect(0,0,g.canvas.width,g.canvas.height);b.redraw();c._zoom.isZoomed=!0}b.target.trigger("jqplotZoom",[a,d,b,c])}};g.jqplot.preInitHooks.push(g.jqplot.Cursor.init);g.jqplot.postDrawHooks.push(g.jqplot.Cursor.postDraw); g.jqplot.CursorLegendRenderer=function(a){g.jqplot.TableLegendRenderer.call(this,a);this.formatString="%s"};g.jqplot.CursorLegendRenderer.prototype=new g.jqplot.TableLegendRenderer;g.jqplot.CursorLegendRenderer.prototype.constructor=g.jqplot.CursorLegendRenderer;g.jqplot.CursorLegendRenderer.prototype.draw=function(){function a(a,b,c,d){var e=c?this.rowSpacing:"0",c=g('<tr class="jqplot-legend jqplot-cursor-legend"></tr>').appendTo(this._elem);c.data("seriesIndex",d);g('<td class="jqplot-legend jqplot-cursor-legend-swatch" style="padding-top:'+ e+';"><div style="border:1px solid #cccccc;padding:0.2em;"><div class="jqplot-cursor-legend-swatch" style="background-color:'+b+';"></div></div></td>').appendTo(c);b=g('<td class="jqplot-legend jqplot-cursor-legend-label" style="vertical-align:middle;padding-top:'+e+';"></td>');b.appendTo(c);b.data("seriesIndex",d);this.escapeHtml?b.text(a):b.html(a)}if(this.show){var d=this._series;this._elem=g('<table class="jqplot-legend jqplot-cursor-legend" style="position:absolute"></table>');for(var b=!1,c= 0;c<d.length;c++)if(s=d[c],s.show){var e=g.jqplot.sprintf(this.formatString,s.label.toString());if(e){var f=s.color;s._stack&&!s.fill&&(f="");a.call(this,e,f,b,c);b=!0}for(e=0;e<g.jqplot.addLegendRowHooks.length;e++)if(f=g.jqplot.addLegendRowHooks[e].call(this,s))a.call(this,f.label,f.color,b),b=!0}}return this._elem}})(jQuery);