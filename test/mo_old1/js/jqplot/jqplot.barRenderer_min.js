(function(g){function n(){for(i=0;i<this.series.length;i++)this.series[i].renderer.constructor==g.jqplot.BarRenderer&&this.series[i].highlightMouseOver&&(this.series[i].highlightMouseDown=!1);this.target.bind("mouseout",{plot:this},function(d){k(d.data.plot)})}function o(){this.plugins.barRenderer={highlightedSeriesIndex:null};this.plugins.barRenderer.highlightCanvas=new g.jqplot.GenericCanvas;this.eventCanvas._elem.before(this.plugins.barRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-barRenderer-highlight-canvas", this._plotDimensions));this.plugins.barRenderer.highlightCanvas.setContext()}function l(d,c,a,b){var e=d.series[c],f=d.plugins.barRenderer.highlightCanvas;f._ctx.clearRect(0,0,f._ctx.canvas.width,f._ctx.canvas.height);e._highlightedPoint=a;d.plugins.barRenderer.highlightedSeriesIndex=c;e.renderer.shapeRenderer.draw(f._ctx,b,{fillStyle:e.highlightColors[a]})}function k(d){var c=d.plugins.barRenderer.highlightCanvas;c._ctx.clearRect(0,0,c._ctx.canvas.width,c._ctx.canvas.height);for(c=0;c<d.series.length;c++)d.series[c]._highlightedPoint= null;d.plugins.barRenderer.highlightedSeriesIndex=null;d.target.trigger("jqplotDataUnhighlight")}function p(d,c,a,b,e){b?(c=[b.seriesIndex,b.pointIndex,b.data],a=jQuery.Event("jqplotDataMouseOver"),a.pageX=d.pageX,a.pageY=d.pageY,e.target.trigger(a,c),e.series[c[0]].highlightMouseOver&&!(c[0]==e.plugins.barRenderer.highlightedSeriesIndex&&c[1]==e.series[c[0]]._highlightedPoint)&&(a=jQuery.Event("jqplotDataHighlight"),a.pageX=d.pageX,a.pageY=d.pageY,e.target.trigger(a,c),l(e,b.seriesIndex,b.pointIndex, b.points))):null==b&&k(e)}function q(d,c,a,b,e){b?(c=[b.seriesIndex,b.pointIndex,b.data],e.series[c[0]].highlightMouseDown&&!(c[0]==e.plugins.barRenderer.highlightedSeriesIndex&&c[1]==e.series[c[0]]._highlightedPoint)&&(a=jQuery.Event("jqplotDataHighlight"),a.pageX=d.pageX,a.pageY=d.pageY,e.target.trigger(a,c),l(e,b.seriesIndex,b.pointIndex,b.points))):null==b&&k(e)}function r(d,c,a,b,e){d=e.plugins.barRenderer.highlightedSeriesIndex;null!=d&&e.series[d].highlightMouseDown&&k(e)}function s(d,c,a, b,e){b&&(c=[b.seriesIndex,b.pointIndex,b.data],a=jQuery.Event("jqplotDataClick"),a.pageX=d.pageX,a.pageY=d.pageY,e.target.trigger(a,c))}function t(d,c,a,b,e){b&&(c=[b.seriesIndex,b.pointIndex,b.data],a=e.plugins.barRenderer.highlightedSeriesIndex,null!=a&&e.series[a].highlightMouseDown&&k(e),a=jQuery.Event("jqplotDataRightClick"),a.pageX=d.pageX,a.pageY=d.pageY,e.target.trigger(a,c))}g.jqplot.BarRenderer=function(){g.jqplot.LineRenderer.call(this)};g.jqplot.BarRenderer.prototype=new g.jqplot.LineRenderer; g.jqplot.BarRenderer.prototype.constructor=g.jqplot.BarRenderer;g.jqplot.BarRenderer.prototype.init=function(d,c){this.barPadding=8;this.barMargin=10;this.barDirection="vertical";this.barWidth=null;this.shadowOffset=2;this.shadowDepth=5;this.shadowAlpha=0.08;this.waterfall=!1;this.groups=1;this.varyBarColor=!1;this.highlightMouseOver=!0;this.highlightMouseDown=!1;this.highlightColors=[];d.highlightMouseDown&&null==d.highlightMouseOver&&(d.highlightMouseOver=!1);g.extend(!0,this,d);this.fill=!0;this.waterfall&& (this.fillToZero=!1,this.disableStack=!0);"vertical"==this.barDirection?(this._primaryAxis="_xaxis",this.fillAxis=this._stackAxis="y"):(this._primaryAxis="_yaxis",this.fillAxis=this._stackAxis="x");this._plotSeriesInfo=this._highlightedPoint=null;this._dataColors=[];this._barPoints=[];this.renderer.shapeRenderer.init({lineJoin:"miter",lineCap:"round",fill:!0,isarc:!1,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill});this.renderer.shadowRenderer.init({lineJoin:"miter",lineCap:"round", fill:!0,isarc:!1,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill});c.postInitHooks.addOnce(n);c.postDrawHooks.addOnce(o);c.eventListenerHooks.addOnce("jqplotMouseMove",p);c.eventListenerHooks.addOnce("jqplotMouseDown",q);c.eventListenerHooks.addOnce("jqplotMouseUp",r);c.eventListenerHooks.addOnce("jqplotClick",s);c.eventListenerHooks.addOnce("jqplotRightClick",t)};g.jqplot.preSeriesInitHooks.push(function(){"horizontal"==this.rendererOptions.barDirection&& (this._stackAxis="x",this._primaryAxis="_yaxis");if(!0==this.rendererOptions.waterfall){this._data=g.extend(!0,[],this.data);for(var d=0,c=!this.rendererOptions.barDirection||"vertical"==this.rendererOptions.barDirection?1:0,a=0;a<this.data.length;a++)d+=this.data[a][c],0<a&&(this.data[a][c]+=this.data[a-1][c]);this.data[this.data.length]=1==c?[this.data.length+1,d]:[d,this.data.length+1];this._data[this._data.length]=1==c?[this._data.length+1,d]:[d,this._data.length+1]}if(1<this.rendererOptions.groups){this.breakOnNull= !0;for(var d=this.data.length,c=parseInt(d/this.rendererOptions.groups,10),b=0,a=c;a<d;a+=c)this.data.splice(a+b,0,[null,null]),b++;for(a=0;a<this.data.length;a++)"_xaxis"==this._primaryAxis?this.data[a][0]=a+1:this.data[a][1]=a+1}});g.jqplot.BarRenderer.prototype.calcSeriesNumbers=function(){for(var d=0,c=0,a=this[this._primaryAxis],b,e,f=0;f<a._series.length;f++)b=a._series[f],b===this&&(e=f),b.renderer.constructor==g.jqplot.BarRenderer&&(d+=b.data.length,c+=1);return[d,c,e]};g.jqplot.BarRenderer.prototype.setBarWidth= function(){var d=0,c=0,a=this[this._primaryAxis],c=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this),d=c[0],c=c[1],b=(a.numberTicks-1)/2;this.barWidth="xaxis"==a.name||"x2axis"==a.name?this._stack?(a._offsets.max-a._offsets.min)/d*c-this.barMargin:((a._offsets.max-a._offsets.min)/b-this.barPadding*(c-1)-2*this.barMargin)/c:this._stack?(a._offsets.min-a._offsets.max)/d*c-this.barMargin:((a._offsets.min-a._offsets.max)/b-this.barPadding*(c-1)-2*this.barMargin)/c;return[d,c]};g.jqplot.BarRenderer.prototype.draw= function(d,c,a){var b,a=void 0!=a?a:{},e=void 0!=a.shadow?a.shadow:this.shadow;b=void 0!=a.showLine?a.showLine:this.showLine;var f,j;this._dataColors=[];this._barPoints=[];null==this.barWidth&&this.renderer.setBarWidth.call(this);j=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);f=j[1];j=j[2];this._barNudge=this._stack?0:(-Math.abs(f/2-0.5)+j)*(this.barWidth+this.barPadding);if(b){f=new g.jqplot.ColorGenerator(this.negativeSeriesColors);j=new g.jqplot.ColorGenerator(this.seriesColors); var k=f.get(this.index);this.useNegativeColors||(k=a.fillStyle);var l=a.fillStyle;if("vertical"==this.barDirection)for(b=0;b<c.length;b++){if(null!=this.data[b][1]){points=[];var h=c[b][0]+this._barNudge,m;m=this._stack&&this._prevGridData.length?this._prevGridData[b][1]:this.fillToZero?this._yaxis.series_u2p(0):this.waterfall&&0<b&&b<this.gridData.length-1?this.gridData[b-1][1]:d.canvas.height;a.fillStyle=this.fillToZero&&0>this._plotData[b][1]||this.waterfall&&0>this._data[b][1]?this.varyBarColor? this.useNegativeColors?f.next():j.next():k:this.varyBarColor?j.next():l;points.push([h-this.barWidth/2,m]);points.push([h-this.barWidth/2,c[b][1]]);points.push([h+this.barWidth/2,c[b][1]]);points.push([h+this.barWidth/2,m]);this._barPoints.push(points);e&&!this._stack&&(h=g.extend(!0,{},a),delete h.fillStyle,this.renderer.shadowRenderer.draw(d,points,h));h=a.fillStyle||this.color;this._dataColors.push(h);this.renderer.shapeRenderer.draw(d,points,a)}}else if("horizontal"==this.barDirection)for(b=0;b< c.length;b++)null!=this.data[b][0]&&(points=[],h=c[b][1]-this._barNudge,k=this._stack&&this._prevGridData.length?this._prevGridData[b][0]:this.fillToZero?this._xaxis.series_u2p(0):this.waterfall&&0<b&&b<this.gridData.length-1?this.gridData[b-1][1]:0,this.fillToZero&&0>this._plotData[b][1]||this.waterfall&&0>this._data[b][1]?this.varyBarColor&&(a.fillStyle=this.useNegativeColors?f.next():j.next()):a.fillStyle=this.varyBarColor?j.next():l,points.push([k,h+this.barWidth/2]),points.push([k,h-this.barWidth/ 2]),points.push([c[b][0],h-this.barWidth/2]),points.push([c[b][0],h+this.barWidth/2]),this._barPoints.push(points),e&&!this._stack&&(h=g.extend(!0,{},a),delete h.fillStyle,this.renderer.shadowRenderer.draw(d,points,h)),h=a.fillStyle||this.color,this._dataColors.push(h),this.renderer.shapeRenderer.draw(d,points,a))}if(0==this.highlightColors.length){d=this._dataColors;c=[];for(a=0;a<d.length;a++){e=g.jqplot.getColorComponents(d[a]);e=[e[0],e[1],e[2]];b=e[0]+e[1]+e[2];for(f=0;3>f;f++)e[f]=570<b?0.8* e[f]:e[f]+0.3*(255-e[f]),e[f]=parseInt(e[f],10);c.push("rgb("+e[0]+","+e[1]+","+e[2]+")")}this.highlightColors=c}else if("string"==typeof this.highlightColors){j=this.highlightColors;this.highlightColors=[];for(b=0;b<this._dataColors.length;b++)this.highlightColors.push(j)}};g.jqplot.BarRenderer.prototype.drawShadow=function(d,c,a){var b,a=void 0!=a?a:{};b=void 0!=a.showLine?a.showLine:this.showLine;var e,f;if(this._stack&&this.shadow&&(null==this.barWidth&&this.renderer.setBarWidth.call(this),f= this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this),e=f[1],f=f[2],this._barNudge=this._stack?0:(-Math.abs(e/2-0.5)+f)*(this.barWidth+this.barPadding),b))if("vertical"==this.barDirection)for(b=0;b<c.length;b++)null!=this.data[b][1]&&(points=[],e=c[b][0]+this._barNudge,f=this._stack&&this._prevGridData.length?this._prevGridData[b][1]:this.fillToZero?this._yaxis.series_u2p(0):d.canvas.height,points.push([e-this.barWidth/2,f]),points.push([e-this.barWidth/2,c[b][1]]),points.push([e+this.barWidth/ 2,c[b][1]]),points.push([e+this.barWidth/2,f]),this.renderer.shadowRenderer.draw(d,points,a));else if("horizontal"==this.barDirection)for(b=0;b<c.length;b++)null!=this.data[b][0]&&(points=[],e=c[b][1]-this._barNudge,f=this._stack&&this._prevGridData.length?this._prevGridData[b][0]:0,points.push([f,e+this.barWidth/2]),points.push([c[b][0],e+this.barWidth/2]),points.push([c[b][0],e-this.barWidth/2]),points.push([f,e-this.barWidth/2]),this.renderer.shadowRenderer.draw(d,points,a))}})(jQuery);